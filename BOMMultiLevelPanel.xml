[SYSPRO APPLICATION DESIGNER]
Version=000000001
Indevelopment=
WindowSize=M
Appname=BOMMULTI
Category=
Apptitle=BOM Multi-Level Structure Viewer
AppCheckChanges=
AppFormGainFocusEvent=
AppTbarGainFocusEvent=
ApplicationType=2
IMPIDEVersion=8.0.034
Author=
ValidateStyling=
AppCreateMainToolbar=1
CanBeSecured=
WindowIcon=
ReleaseVersion=
LastModified=20251112
AppShowNotes=
Statusbar=
Messagebar=
MessagebarText=
MessageCloseButton=
MessageButtonText=
ShowModalInAvanti=
EmbedWebView=
EncryptApp=
InitialFocus=Toolbar (Stock code, ID 38001)
Notes=
[DOCKING LAYOUT]
<Layout><Common CompactMode="1"><Summary Panes="19" TopContainer="11" Client="16"/><Pane-1 Type="0" DockingCX="350" DockingCY="600" Title="BOM Structure Tree" ID="1" DockingHolder="14" LastHolder="14"/><Pane-2 Type="0" DockingCX="400" DockingCY="200" Title="Parent Header Details" ID="2" DockingHolder="13" LastHolder="13"/><Pane-3 Type="0" DockingCX="500" DockingCY="300" Title="Material Allocations" ID="3" DockingHolder="15" LastHolder="15"/><Pane-4 Type="0" DockingCX="500" DockingCY="300" Title="Operations" ID="4" DockingHolder="17" LastHolder="17"/><Pane-5 Type="5" DockingCX="0" DockingCY="0" Direction="0" Panes="1" Pane-1="7"/><Pane-6 Type="1" DockingCX="400" DockingCY="200" Panes="1" Selected="2" Pane-1="2"/><Pane-11 Type="2" DockingCX="0" DockingCY="796" Panes="2" Pane-1="12" Pane-2="17"/><Pane-12 Type="2" DockingCX="350" DockingCY="600" Horiz="1" Panes="2" Pane-1="13" Pane-2="14"/><Pane-13 Type="1" DockingCX="400" DockingCY="200" Panes="1" Selected="2" Pane-1="2"/><Pane-14 Type="1" DockingCX="350" DockingCY="600" Panes="1" Selected="1" Pane-1="1"/><Pane-15 Type="1" DockingCX="500" DockingCY="300" Panes="1" Selected="3" Pane-1="3"/><Pane-16 Type="4" DockingCX="0" DockingCY="0"/><Pane-17 Type="2" DockingCX="500" DockingCY="376" Horiz="0" Panes="2" Pane-1="15" Pane-2="18"/><Pane-18 Type="1" DockingCX="500" DockingCY="300" Panes="1" Selected="4" Pane-1="4"/></Common></Layout>
[END DOCKING LAYOUT]
[APPLICATION TOOLBAR]
<DesignerFile CompactMode="1" Schema="44"><CommandBars><CommandBar Class="CXTPToolBar" BarID="1694431857" Flags="1048577" Style="4194304" Title="Standard" MRUWidth="32767" Closeable="0"><Controls><Control Class="CXTPControlComboBox" Type="5" Id="38001" Caption="&amp;Stock code" TooltipText="Enter Stock code" Style="1" Width="150" Height="0" CommandBarId="16777216"/><Control Class="CXTPControlButton" Id="58001" IconId="156" Caption="Browse" TooltipText="Browse stock codes" Style="2" Width="0" Height="0"/><Control Class="CXTPControlButton" Id="58002" IconId="121" Caption="&amp;Load BOM" TooltipText="Load BOM structure" Style="2" Width="0" Height="0"/><Control Class="CXTPControlButton" Id="1002" IconId="121" Caption="&amp;Help" DescriptionText="dbox=BOMMULTIN0;" Style="3" Width="0" Height="0"/></Controls></CommandBar><CommandBar Class="CXTPControlComboBoxList" Type="2" Position="6" BarID="16777216" MRUWidth="0" TearOffWidth="0"/></CommandBars><Layout><DockState Version="44" ScreenSize="1920, 1080" Count="1"><BarInfo0 BarId="1694431857" MRUWidth="32767"/></DockState><DockBars><DockBar0 Count="3" Id1="1694431857"/></DockBars><StatusBar Visible="0"/></Layout><Shortcuts Schema="44"/><Options Theme="12" Schema="44" AlwaysShowFullMenus="0" ShowFullAfterDelay="1" ToolBarScreenTips="1" ToolBarAccelTips="1" LargeIcons="0" Animation="0" SyncFloatingBars="1" ShowExpandButtonAlways="0" IconsSize="0, 0" LargeIconsSize="0, 0" IconsWithShadow="0" UseDisabledIcons="1" UseFadedIcons="0" DblClickFloat="0" ShowTextBelowIcons="0" AltDragCustomization="1" AutoHideUnusedPopups="1" PopupIconsSize="0, 0" KeyboardCuesUse="1" KeyboardCuesShow="2" AutoScaleDpiGalleryItems="1" AutoScaleDpiToolbarIcons="0" AutoScaleDpiToolbarIconsModified="0" ShowPopupButtonsSelectedToolbarOnly="0" Customizable="1"/></DesignerFile>
[END APPLICATION TOOLBAR]
[LISTVIEWS]
[PANE003]
Name=BOMMULTIL0
DisableCloseButton=0
DialogBoxSize=S
Editable=0
CRAction=
MultiCheckBoxSelection=
UnrestrictedDrop=
ShowAllColumns=
AvantiRowSelected=
AvantiShowSelect=
AvantiShowEdit=
AvantiShowDelete=
AvantiDeleteToolbar=
AvantiAutoDisableColumns=
AvantiShowCheckBoxes=
AvantiHyperlinkColumns=
AvantiDynamicComboBoxes=
[BIND-DATA]
BindData=O
BindDataIfHidden=1
BindPrimaryNode=Component
BindPrimaryNodePath=
BindBusinessObject=
BindEvent=
BindControl=
RowDataSource=
RowKeyColumn=
RowShowDialogBox=
BindDataSource=BOM components multi level
BindXMLFile=
BindColumn=00Component
BindColumn=01Description
BindColumn=02PartCategory
BindColumn=03StockUom
BindColumn=04SequenceNum
BindColumn=05QtyPer
BindColumn=06Level
[END-BIND-DATA]
<ReportControl Name="BOMMULTIL0.XML"><Report  AllowColumnSort="true"  AllowColumnAutoSize="true"  Footer="false"  FreezeColumnCount="0"  HorizontalGridStyle="xtpGridSolid" MultipleSelection="false"  PreviewMode="false"  ShowColumnHeader="true"  SetNoItemstext=""  ShowGroupBox="false"  PreviewTextIndent="0"  TreeIndent="20" TreeStructureStyle="xtpTreeStructureSolid"  VerticalGridStyle="xtpGridNoLines"  UseDBlockLVHeading="false"  DoNotSaveSettings="false"  MultiLineLayout="false"  AutoDisableCheckBox="false"  AutoDeleteWithDel="false"  AutoInsertRow="false"  AutoRowHighlight="false"  EnableDragDrop="false"  ResizeHeight="True" ResizeWidth="True" InitialSortAscending=" "  InitialSortColumn="000"  HasToolbar="false"  AllowPageSize="false"  AddVisibleValuesOnly="false"  ShowPaneCaption="false"  AlwaysShowInplaceButtons="false"  MultiLineHeadings="false"  AutoUndo="false"  DeleteRecords="PhysicalDelete"  ShortenedToolbar="false"  NoInitialRowSelected="false"  InitialGroupColumn="000" PrintLandscape="false"  Heading="Material Allocations" />
<Columns>
<Column ItemIndex="000" Caption="Component" Width="120" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="001" Caption="Description" Width="200" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="002" Caption="Part Category" Width="100" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="003" Caption="UOM" Width="80" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="004" Caption="Sequence" Width="80" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="005" Caption="Qty Per" Width="100" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentRight" FooterText="" DataType="xtpNumeric" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="3" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="006" Caption="Level" Width="60" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentCenter" FooterText="" DataType="xtpNumeric" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
</Columns>
</ReportControl>
[PANE004]
Name=BOMMULTIL1
DisableCloseButton=0
DialogBoxSize=S
Editable=0
CRAction=
MultiCheckBoxSelection=
UnrestrictedDrop=
ShowAllColumns=
AvantiRowSelected=
AvantiShowSelect=
AvantiShowEdit=
AvantiShowDelete=
AvantiDeleteToolbar=
AvantiAutoDisableColumns=
AvantiShowCheckBoxes=
AvantiHyperlinkColumns=
AvantiDynamicComboBoxes=
[BIND-DATA]
BindData=O
BindDataIfHidden=1
BindPrimaryNode=Operation
BindPrimaryNodePath=
BindBusinessObject=
BindEvent=
BindControl=
RowDataSource=
RowKeyColumn=
RowShowDialogBox=
BindDataSource=BOM operations
BindXMLFile=
BindColumn=00Operation
BindColumn=01WorkCentre
BindColumn=02Description
BindColumn=03TimeUom
BindColumn=04OperationCostTotal
[END-BIND-DATA]
<ReportControl Name="BOMMULTIL1.XML"><Report  AllowColumnSort="true"  AllowColumnAutoSize="true"  Footer="false"  FreezeColumnCount="0"  HorizontalGridStyle="xtpGridSolid" MultipleSelection="false"  PreviewMode="false"  ShowColumnHeader="true"  SetNoItemstext=""  ShowGroupBox="false"  PreviewTextIndent="0"  TreeIndent="20" TreeStructureStyle="xtpTreeStructureSolid"  VerticalGridStyle="xtpGridNoLines"  UseDBlockLVHeading="false"  DoNotSaveSettings="false"  MultiLineLayout="false"  AutoDisableCheckBox="false"  AutoDeleteWithDel="false"  AutoInsertRow="false"  AutoRowHighlight="false"  EnableDragDrop="false"  ResizeHeight="True" ResizeWidth="True" InitialSortAscending=" "  InitialSortColumn="000"  HasToolbar="false"  AllowPageSize="false"  AddVisibleValuesOnly="false"  ShowPaneCaption="false"  AlwaysShowInplaceButtons="false"  MultiLineHeadings="false"  AutoUndo="false"  DeleteRecords="PhysicalDelete"  ShortenedToolbar="false"  NoInitialRowSelected="false"  InitialGroupColumn="000" PrintLandscape="false"  Heading="Operations" />
<Columns>
<Column ItemIndex="000" Caption="Operation" Width="100" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="001" Caption="Work Centre" Width="120" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="002" Caption="Description" Width="250" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="003" Caption="Time UOM" Width="80" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="004" Caption="Total Cost" Width="120" Icon="-1 " Sortable="True" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="True" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentRight" FooterText="" DataType="xtpNumeric" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="2" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
</Columns>
</ReportControl>
[PANE002]
Name=BOMMULTIL2
DisableCloseButton=0
DialogBoxSize=S
Editable=0
CRAction=
MultiCheckBoxSelection=
UnrestrictedDrop=
ShowAllColumns=
AvantiRowSelected=
AvantiShowSelect=
AvantiShowEdit=
AvantiShowDelete=
AvantiDeleteToolbar=
AvantiAutoDisableColumns=
AvantiShowCheckBoxes=
AvantiHyperlinkColumns=
AvantiDynamicComboBoxes=
[BIND-DATA]
BindData=O
BindDataIfHidden=1
BindPrimaryNode=Parent
BindPrimaryNodePath=
BindBusinessObject=
BindEvent=
BindControl=
RowDataSource=
RowKeyColumn=
RowShowDialogBox=
BindDataSource=BOM parent header
BindXMLFile=
BindColumn=00Field
BindColumn=01Value
[END-BIND-DATA]
<ReportControl Name="BOMMULTIL2.XML"><Report  AllowColumnSort="false"  AllowColumnAutoSize="true"  Footer="false"  FreezeColumnCount="0"  HorizontalGridStyle="xtpGridNoLines" MultipleSelection="false"  PreviewMode="false"  ShowColumnHeader="true"  SetNoItemstext=""  ShowGroupBox="false"  PreviewTextIndent="0"  TreeIndent="20" TreeStructureStyle="xtpTreeStructureSolid"  VerticalGridStyle="xtpGridNoLines"  UseDBlockLVHeading="false"  DoNotSaveSettings="false"  MultiLineLayout="false"  AutoDisableCheckBox="false"  AutoDeleteWithDel="false"  AutoInsertRow="false"  AutoRowHighlight="false"  EnableDragDrop="false"  ResizeHeight="True" ResizeWidth="True" InitialSortAscending=" "  InitialSortColumn="000"  HasToolbar="false"  AllowPageSize="false"  AddVisibleValuesOnly="false"  ShowPaneCaption="false"  AlwaysShowInplaceButtons="false"  MultiLineHeadings="false"  AutoUndo="false"  DeleteRecords="PhysicalDelete"  ShortenedToolbar="false"  NoInitialRowSelected="false"  InitialGroupColumn="000" PrintLandscape="false"  Heading="Parent Header Details" />
<Columns>
<Column ItemIndex="000" Caption="Field" Width="180" Icon="-1 " Sortable="False" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="False" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
<Column ItemIndex="001" Caption="Value" Width="300" Icon="-1 " Sortable="False" AllowRemove="True" AllowDrag="True" TreeColumn="False" Resizable="True" Groupable="False" FooterAlignment="xtpAlignmentLeft" HeaderAlignment="xtpAlignmentLeft" ColumnAlignment="xtpAlignmentLeft" FooterText="" DataType="xtpAlpha" Editable="xtpNoteditable" Format="" EditLength="000" BlankWhenZero="false" AutoColumnHide=" " Translate="false" IsCompanyColumn="false" MultiCompanyColumn="false" CopyTextOnInsert="false" CheckBox="xtpNoCheckBox" HasExpandButton="false" CheckDuplicate="false" AddIfInvisible="false" AllowNegative="false" CustomFormID="" CustomPaneID="" EditDecimals="0" PostEvent="xtpNoPostValidateEvent" Visible="xtpVisible" MoveColumnTo=" "/>
</Columns>
</ReportControl>
[END-LISTVIEWS]
[TREEVIEWS]
[PANE001]
Name=BOMMULTIX0
DisableCloseButton=0
DialogBoxSize=S
KeepSorted=
MultiLevel=Y
[END-TREEVIEWS]
[NOTEPADS]
[PANE005]
Name=BOMMULTIN0
Dialogbox=1
DisableCloseButton=0
DialogBoxSize=S
ReadOnly=0
TextOnly=
Allowsave=
Textfile=
Allowdate=
SaveContents=1
RefreshNotepad=
[NOTEPADCONTENT-000000658]
{\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang2057{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}{\f1\fnil\fcharset0 Segoe UI;}}
{\*\generator Riched20 10.0.20348}\viewkind4\uc1
\pard\b\f0\fs22 BOM Multi-Level Structure Viewer\b0\par
This application displays a Bill of Materials with multiple levels in a tree structure.\par
\par
\b Features:\b0\par
- Enter a stock code in the toolbar and click "Load BOM" to view the structure\par
- The tree view shows the complete multi-level BOM hierarchy\par
- Parent Header Details pane shows information about the selected item\par
- Material Allocations pane lists all components with quantities\par
- Operations pane displays routing operations with work centers and costs\par
\par
The application uses the \b BOMQRY\b0 business object with multi-level query option to retrieve the complete BOM structure.\par
\f1\fs20\par
}

[END-NOTEPADCONTENT]
[END-NOTEPADS]
[VBSCRIPT]
Option Explicit

''''''''''''''''''''''''''''''''''''''''''''''''''''''
'AppName: BOMMULTI
'Date: 2025-11-12
'Author: Application Designer
''''''''''''''''''''''''''''''''''''''''''''''''''''''
'This App displays a multi-level BOM structure with:
'- Tree view showing complete hierarchy
'- Parent header details
'- Material allocations
'- Operations
'Uses BOMQRY business object with Level=M (Multi-level)

'Define constants for toolbar controls
const Tbar_StockCode = "38001"
const Tbar_Browse = "58001"
const Tbar_LoadBOM = "58002"
const Tbar_Help = "01002"

'Global variables
dim g_currentStockCode
dim g_bomXML

Function AppDesigner_OnInitialization()
    g_currentStockCode = ""
    g_bomXML = ""
End Function

Function AppDesigner_OnUserEvent(EventType,EventName,EventID,Param1,Param2,Param3)

    If EventType = ToolbarEvent Then
        Select Case EventID

            Case Tbar_Help
                ' Help is already configured in toolbar

            Case Tbar_Browse
                ' Browse button - could integrate with stock code browse
                Call MsgBox("Browse functionality - integrate with SYSPRO browse", vbInformation, "Browse")

            Case Tbar_LoadBOM, Tbar_StockCode
                ' Load BOM when Load button clicked or Enter pressed in stock code
                Dim stockCode
                stockCode = CallSYSPROFunction(ToolbarGetValue, "BOMMULTITB", Tbar_StockCode)

                If Trim(stockCode) = "" Then
                    Call MsgBox("Please enter a stock code", vbExclamation, "Stock Code Required")
                    Exit Function
                End If

                Call LoadBOMStructure(stockCode)

            Case Else
                ' Unknown toolbar event

        End Select
    End If

    'Catch treeview events
    If EventType = TreeviewEvent Then
        Select Case EventID
            Case TreeClicked, TreeExpand
                ' When a tree node is clicked or expanded, update the detail panes
                ' Param1 contains the stock code (value)
                If Not IsEmpty(Param1) And Param1 <> "" Then
                    Call LoadItemDetails(Param1)
                End If

        End Select
    End If

End Function

''''''''''''''''''''''''''
' Main BOM Loading Function
''''''''''''''''''''''''''
Function LoadBOMStructure(strStockCode)
    On Error Resume Next

    ' Store current stock code
    g_currentStockCode = strStockCode

    ' Execute BOMQRY business object with multi-level option
    g_bomXML = GetMultiLevelBOMStructure(strStockCode)

    If g_bomXML = "" Then
        Call MsgBox("No BOM data found for stock code: " & strStockCode, vbExclamation, "No Data")
        Call CallSYSPROFunction(TreeClear, "BOMMULTIX0", " ")
        Call CallSYSPROFunction(ListviewClearRecords, "BOMMULTIL0", " ")
        Call CallSYSPROFunction(ListviewClearRecords, "BOMMULTIL1", " ")
        Call CallSYSPROFunction(ListviewClearRecords, "BOMMULTIL2", " ")
        Exit Function
    End If

    ' Check for errors
    Dim errMsg
    errMsg = SysproCheckForErrors(g_bomXML)
    If errMsg <> "" Then
        Call MsgBox("Error loading BOM: " & vbCrLf & errMsg, vbCritical, "BOM Query Error")
        Exit Function
    End If

    ' Build and populate the tree view
    Call PopulateTreeView(g_bomXML)

    ' Populate parent header details
    Call PopulateParentHeader(g_bomXML)

    ' Populate operations list
    Call PopulateOperations(g_bomXML)

    ' Populate materials list (components)
    Call PopulateMaterials(g_bomXML)

End Function

''''''''''''''''''''''''''
' Get Multi-Level BOM Structure from BOMQRY
''''''''''''''''''''''''''
Function GetMultiLevelBOMStructure(pStockCode)
    ' Execute the data source for multi-level BOM query
    GetMultiLevelBOMStructure = CallSYSPROFunction(DataSourceExecute, "BOM multi level query", pStockCode)
End Function

''''''''''''''''''''''''''
' Populate Tree View with Multi-Level BOM
''''''''''''''''''''''''''
Function PopulateTreeView(xmlData)
    On Error Resume Next

    Dim xmldom, ParseErr, sErrMsg
    Set xmldom = CreateObject("MSXML2.DOMDocument")
    xmldom.async = "false"

    If Not xmldom.loadxml(xmlData) Then
        Set ParseErr = xmldom.parseError
        sErrMsg = "XML Parsing Error: " & VbCrLf & ParseErr.reason
        Call MsgBox(sErrMsg, vbCritical, "Parse Error")
        Exit Function
    End If

    xmldom.setProperty "SelectionLanguage", "XPath"

    ' Get parent node
    Dim parentNode
    Set parentNode = xmldom.documentElement.selectsinglenode("/BomQuery/Parent")

    If parentNode Is Nothing Then
        Call MsgBox("Unable to find Parent node in BOM data", vbExclamation, "Data Error")
        Exit Function
    End If

    ' Clear existing tree
    Call CallSYSPROFunction(TreeClear, "BOMMULTIX0", " ")

    ' Build tree XML
    Dim treeXML
    treeXML = "<Items>"

    ' Add parent item
    treeXML = treeXML & BuildParentTreeItem(parentNode)

    ' Add components recursively
    Dim componentNodes
    Set componentNodes = parentNode.selectnodes("Component")

    If componentNodes.Length > 0 Then
        treeXML = treeXML & BuildComponentTreeItems(componentNodes, 1)
    End If

    treeXML = treeXML & "</Items>"

    ' Populate tree view
    Call CallSYSPROFunction(TreeAddXAMLItems, "BOMMULTIX0", treeXML)

End Function

''''''''''''''''''''''''''
' Build Parent Tree Item
''''''''''''''''''''''''''
Function BuildParentTreeItem(parentNode)
    On Error Resume Next

    Dim stockCode, description, icon
    stockCode = GetNodeText(parentNode, "StockCode")
    description = GetNodeText(parentNode, "Description")
    icon = GetNodeText(parentNode, "IconOpen")

    If icon = "" Then icon = "4"

    Dim xaml
    xaml = "{TextBlock}{Bold}" & stockCode & "{/Bold} - " & description & "{/TextBlock}"

    BuildParentTreeItem = "<Item Parent='0' XAML='" & EscapeXML(xaml) & _
                         "' Key='" & EscapeXML(stockCode) & _
                         "' Value='" & EscapeXML(stockCode) & _
                         "' Icon='" & icon & "' HasChildren='Y'/>"
End Function

''''''''''''''''''''''''''
' Build Component Tree Items (Recursive)
''''''''''''''''''''''''''
Function BuildComponentTreeItems(componentNodes, parentIndex)
    On Error Resume Next

    Dim strXML, node
    strXML = ""

    Dim nodeIndex
    nodeIndex = parentIndex

    For Each node In componentNodes
        Dim stockCode, description, seqNum, qty, uom, icon
        stockCode = GetNodeText(node, "Component")
        description = GetNodeText(node, "Description")
        seqNum = GetNodeText(node, "SequenceNum")
        qty = GetNodeText(node, "QtyPer")
        uom = GetNodeText(node, "StockUom")
        icon = GetNodeText(node, "IconOpen")

        If icon = "" Then icon = "1"

        ' Check if this component has sub-assemblies
        Dim hasChildren
        hasChildren = "N"
        If icon = "4" Or icon = "5" Then
            hasChildren = "Y"
        End If

        ' Build XAML for tree node
        Dim xaml
        xaml = "{TextBlock}{Bold}" & seqNum & " " & stockCode & "{/Bold} " & description & _
               " ({Run Foreground=""Blue"" Text=""" & qty & " " & uom & """/}){/TextBlock}"

        strXML = strXML & "<Item Parent='" & parentIndex & "' HasChildren='" & hasChildren & _
                "' XAML='" & EscapeXML(xaml) & _
                "' Key='" & EscapeXML(stockCode) & _
                "' Value='" & EscapeXML(stockCode) & _
                "' Icon='" & icon & "'/>"

        ' Process sub-assemblies recursively
        Dim subAssemblyNodes
        Set subAssemblyNodes = node.selectnodes("SubAssembly/Component")

        If Not subAssemblyNodes Is Nothing And subAssemblyNodes.Length > 0 Then
            ' Note: This is a simplified version. For true multi-level,
            ' you may need to track node indices more carefully
            strXML = strXML & BuildComponentTreeItems(subAssemblyNodes, nodeIndex)
        End If

    Next

    BuildComponentTreeItems = strXML
End Function

''''''''''''''''''''''''''
' Populate Parent Header Details
''''''''''''''''''''''''''
Function PopulateParentHeader(xmlData)
    On Error Resume Next

    Dim xmldom, parentNode
    Set xmldom = CreateObject("MSXML2.DOMDocument")
    xmldom.async = "false"
    xmldom.loadxml(xmlData)
    xmldom.setProperty "SelectionLanguage", "XPath"

    Set parentNode = xmldom.documentElement.selectsinglenode("/BomQuery/Parent")

    If parentNode Is Nothing Then Exit Function

    ' Build header data as XML for listview
    Dim headerXML
    headerXML = "<?xml version='1.0' encoding='UTF-8'?><BomQuery><Parent>"
    headerXML = headerXML & "<Item><Field>Stock Code</Field><Value>" & EscapeXML(GetNodeText(parentNode, "StockCode")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Description</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Description")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Long Description</Field><Value>" & EscapeXML(GetNodeText(parentNode, "LongDesc")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Part Category</Field><Value>" & EscapeXML(GetNodeText(parentNode, "PartCategory")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Stock UOM</Field><Value>" & EscapeXML(GetNodeText(parentNode, "StockUom")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Product Class</Field><Value>" & EscapeXML(GetNodeText(parentNode, "ProductClass")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Warehouse</Field><Value>" & EscapeXML(GetNodeText(parentNode, "WarehouseToUse")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Version</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Version")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Release</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Release")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Route</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Route")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Route Description</Field><Value>" & EscapeXML(GetNodeText(parentNode, "BOMROU_Description")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>EBQ</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Ebq")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Planner</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Planner")) & "</Value></Item>"
    headerXML = headerXML & "<Item><Field>Buyer</Field><Value>" & EscapeXML(GetNodeText(parentNode, "Buyer")) & "</Value></Item>"
    headerXML = headerXML & "</Parent></BomQuery>"

    ' Manually populate listview by clearing and adding records
    Call CallSYSPROFunction(ListviewClearAddRecords, "BOMMULTIL2", headerXML)

End Function

''''''''''''''''''''''''''
' Populate Operations List
''''''''''''''''''''''''''
Function PopulateOperations(xmlData)
    On Error Resume Next

    ' Execute data source for operations
    Dim returnValue
    returnValue = CallSYSPROFunction(DataSourceExecute, "BOM operations", g_currentStockCode)
    Call CallSYSPROFunction(ListviewClearAddRecords, "BOMMULTIL1", returnValue)

End Function

''''''''''''''''''''''''''
' Populate Materials List (All Components)
''''''''''''''''''''''''''
Function PopulateMaterials(xmlData)
    On Error Resume Next

    ' Execute data source for multi-level components
    Dim returnValue
    returnValue = CallSYSPROFunction(DataSourceExecute, "BOM components multi level", g_currentStockCode)
    Call CallSYSPROFunction(ListviewClearAddRecords, "BOMMULTIL0", returnValue)

End Function

''''''''''''''''''''''''''
' Load Item Details when tree node is clicked
''''''''''''''''''''''''''
Function LoadItemDetails(strStockCode)
    On Error Resume Next

    ' When a specific component is clicked, you could load its specific details
    ' For now, we'll keep showing the original parent's operations and materials
    ' In a more advanced version, you could query the clicked item's BOM

    ' Optional: Load BOM for the clicked item
    ' Call LoadBOMStructure(strStockCode)

End Function

''''''''''''''''''''''''''
' Utility Functions
''''''''''''''''''''''''''

Function GetNodeText(parentNode, nodeName)
    On Error Resume Next
    Dim node
    Set node = parentNode.selectsinglenode(nodeName)
    If Not node Is Nothing Then
        GetNodeText = node.Text
    Else
        GetNodeText = ""
    End If
End Function

Function EscapeXML(str)
    On Error Resume Next
    Dim result
    result = str
    result = Replace(result, "&", "&amp;")
    result = Replace(result, "<", "&lt;")
    result = Replace(result, ">", "&gt;")
    result = Replace(result, "'", "&apos;")
    result = Replace(result, """", "&quot;")
    EscapeXML = result
End Function

Function SysproCheckForErrors(strXMLOut)
    'This function checks to see if the XMLOut returned by a Business Object
    'has any errors and returns a formatted string of those errors
    'If there are no errors then it returns an empty string

    On Error Resume Next

    Dim m_XMLDOC, nodeList, errornode, strError

    Set m_XMLDOC = CreateObject("MSXML2.DOMDocument")
    m_XMLDOC.async = "false"
    m_XMLDOC.loadXML(strXMLOut)

    Set nodeList = m_XMLDOC.SelectNodes("//ErrorDescription")

    If nodeList.Length = 0 Then
        SysproCheckForErrors = ""
    Else
        For Each errornode In nodeList
            strError = strError & errornode.Text & vbCrLf
        Next
        SysproCheckForErrors = strError
    End If

End Function

[END VBSCRIPT]
[DATA SOURCES]
Name=BOM multi level query;Type=B;BO=BOMQRY;QP=Q;Node=Parent;NodePath=;Repeat=N;Table=;Clear= ;ShowError=1;TranError=N;TranType=P;ReturnAll= ;Msg=The key '%key%' is invalid for the name '%name%'.;BlankKey= ;XMLStyle= ;Provider= ;XMLIN=<Query>  <Key>    <StockCode>%key%</StockCode>  </Key>  <Option>    <Version />    <Release />    <Route>0</Route>    <UnitOfMeasure>S</UnitOfMeasure>    <CostBasis>B</CostBasis>    <IncludeIcons>Y</IncludeIcons>    <Level>M</Level>    <IncludeComponentNarrations>N</IncludeComponentNarrations>    <IncludeOperationNarrations>N</IncludeOperationNarrations>    <IncludeCustomForms>N</IncludeCustomForms>    <IncludeCoProduct>N</IncludeCoProduct>    <XslStylesheet />    <UseWhRoute>N</UseWhRoute>    <Warehouse />  </Option></Query> ;ConnectionName=;MapRepeat=;MapData= ;MapOutput= ;;SQL= ]]
Name=BOM components multi level;Type=B;BO=BOMQRY;QP=Q;Node=Component;NodePath=;Repeat=Y;Table=;Clear= ;ShowError=1;TranError=N;TranType=P;ReturnAll= ;Msg=The key '%key%' is invalid.;BlankKey= ;XMLStyle= ;Provider= ;XMLIN=<Query>  <Key>    <StockCode>%key%</StockCode>  </Key>  <Option>    <Version />    <Release />    <Route>0</Route>    <UnitOfMeasure>S</UnitOfMeasure>    <CostBasis>B</CostBasis>    <IncludeIcons>Y</IncludeIcons>    <Level>M</Level>    <IncludeComponentNarrations>N</IncludeComponentNarrations>    <IncludeOperationNarrations>N</IncludeOperationNarrations>    <IncludeCustomForms>N</IncludeCustomForms>    <IncludeCoProduct>N</IncludeCoProduct>    <XslStylesheet />    <UseWhRoute>N</UseWhRoute>    <Warehouse />  </Option></Query> ;ConnectionName=;MapRepeat=;MapData= ;MapOutput= ;;SQL= ]]
Name=BOM operations;Type=B;BO=BOMQRY;QP=Q;Node=Operation;NodePath=Parent;Repeat=Y;Table=;Clear= ;ShowError=1;TranError=N;TranType=P;ReturnAll= ;Msg=The key '%key%' is invalid.;BlankKey= ;XMLStyle= ;Provider= ;XMLIN=<Query>  <Key>    <StockCode>%key%</StockCode>  </Key>  <Option>    <Version />    <Release />    <Route>0</Route>    <UnitOfMeasure>S</UnitOfMeasure>    <CostBasis>B</CostBasis>    <IncludeIcons>Y</IncludeIcons>    <Level>M</Level>    <IncludeComponentNarrations>N</IncludeComponentNarrations>    <IncludeOperationNarrations>N</IncludeOperationNarrations>    <IncludeCustomForms>N</IncludeCustomForms>    <IncludeCoProduct>N</IncludeCoProduct>    <XslStylesheet />    <UseWhRoute>N</UseWhRoute>    <Warehouse />  </Option></Query> ;ConnectionName=;MapRepeat=;MapData= ;MapOutput= ;;SQL= ]]
Name=BOM parent header;Type=B;BO=BOMQRY;QP=Q;Node=Parent;NodePath=;Repeat=N;Table=;Clear= ;ShowError=1;TranError=N;TranType=P;ReturnAll= ;Msg=The key '%key%' is invalid.;BlankKey= ;XMLStyle= ;Provider= ;XMLIN=<Query>  <Key>    <StockCode>%key%</StockCode>  </Key>  <Option>    <Version />    <Release />    <Route>0</Route>    <UnitOfMeasure>S</UnitOfMeasure>    <CostBasis>B</CostBasis>    <IncludeIcons>Y</IncludeIcons>    <Level>S</Level>    <IncludeComponentNarrations>N</IncludeComponentNarrations>    <IncludeOperationNarrations>N</IncludeOperationNarrations>    <IncludeCustomForms>N</IncludeCustomForms>    <IncludeCoProduct>N</IncludeCoProduct>    <XslStylesheet />    <UseWhRoute>N</UseWhRoute>    <Warehouse />  </Option></Query> ;ConnectionName=;MapRepeat=;MapData= ;MapOutput= ;;SQL= ]]
[END DATA SOURCES]
[END SYSPRO APPLICATION DESIGNER]
